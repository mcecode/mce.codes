---
import type { ImageMetadata } from "astro";

type Props = {
	alt: string;
	class?: string | { picture: string; img: string };
	resize?: "up" | "down";
} & ImageMetadata;

let pictureClass;
let imgClass;
if (typeof Astro.props.class === "string") {
	pictureClass = Astro.props.class;
}
if (typeof Astro.props.class === "object" && Astro.props.class !== null) {
	pictureClass = Astro.props.class.picture;
	imgClass = Astro.props.class.img;
}

const { resize = "" } = Astro.props;
if (resize === "down") {
	Astro.props.width = Astro.props.width * 0.25;
	Astro.props.height = Astro.props.height * 0.25;
}

const { alt, src, width, height } = Astro.props;
---

<picture optimize-media optimize-media-resize={resize} class={pictureClass}>
	<img
		{src}
		{alt}
		{width}
		{height}
		class={imgClass}
		decoding="async"
		loading="lazy"
	/>
</picture>
